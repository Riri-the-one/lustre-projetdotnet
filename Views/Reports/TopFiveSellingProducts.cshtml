@model ProjetDotNet.Models.DTOs.TopNSoldProductsVm
@{
	Layout = "_AdminLayout";
	ViewData["Title"] = "Top Selling Products";
}

<style>
	.reports-container {
		max-width: 1400px;
		margin: 0 auto;
	}

	.reports-header {
		background: linear-gradient(135deg, #FFFFFF 0%, #FEFCF9 100%);
		border-radius: 20px;
		padding: 30px;
		margin-bottom: 30px;
		box-shadow: 0 4px 20px rgba(61, 40, 23, 0.08);
		border: 1px solid rgba(232, 213, 196, 0.3);
	}

	.reports-title {
		font-family: 'Playfair Display', serif;
		font-size: 32px;
		font-weight: 400;
		color: var(--dark-brown);
		font-style: italic;
		margin-bottom: 20px;
	}

	.date-filter-form {
		display: flex;
		gap: 15px;
		align-items: end;
		flex-wrap: wrap;
	}

	.date-filter-group {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.date-filter-group label {
		font-size: 14px;
		font-weight: 600;
		color: var(--text-dark);
	}

	.date-filter-group input {
		padding: 10px 15px;
		border: 2px solid rgba(232, 213, 196, 0.5);
		border-radius: 8px;
		font-size: 14px;
		background: white;
		color: var(--text-dark);
		transition: all 0.3s ease;
	}

	.date-filter-group input:focus {
		outline: none;
		border-color: var(--light-brown);
		box-shadow: 0 0 0 3px rgba(139, 111, 71, 0.1);
	}

	.filter-btn {
		padding: 10px 25px;
		background: linear-gradient(135deg, var(--dark-brown) 0%, #8B6F47 100%);
		color: white;
		border: none;
		border-radius: 8px;
		font-size: 14px;
		font-weight: 600;
		cursor: pointer;
		transition: all 0.3s ease;
		display: inline-flex;
		align-items: center;
		gap: 8px;
	}

	.filter-btn:hover {
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(61, 40, 23, 0.3);
	}

	.reports-content {
		background: linear-gradient(135deg, #FFFFFF 0%, #FEFCF9 100%);
		border-radius: 20px;
		padding: 30px;
		box-shadow: 0 4px 20px rgba(61, 40, 23, 0.08);
		border: 1px solid rgba(232, 213, 196, 0.3);
	}

	.date-range-info {
		background: linear-gradient(135deg, rgba(232, 213, 196, 0.2) 0%, rgba(232, 213, 196, 0.1) 100%);
		padding: 15px 20px;
		border-radius: 12px;
		margin-bottom: 25px;
		font-size: 14px;
		color: var(--text-dark);
	}

	.products-table {
		width: 100%;
		border-collapse: collapse;
	}

	.products-table thead {
		background: linear-gradient(135deg, var(--dark-brown) 0%, #8B6F47 100%);
		color: white;
	}

	.products-table th {
		padding: 15px;
		text-align: left;
		font-weight: 600;
		font-size: 14px;
		text-transform: uppercase;
		letter-spacing: 0.5px;
	}

	.products-table td {
		padding: 18px 15px;
		border-bottom: 1px solid rgba(232, 213, 196, 0.3);
		color: var(--text-dark);
	}

	.products-table tbody tr {
		transition: all 0.3s ease;
	}

	.products-table tbody tr:hover {
		background-color: rgba(232, 213, 196, 0.1);
		transform: translateX(5px);
	}

	.rank-badge {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		font-weight: 700;
		font-size: 16px;
		color: white;
	}

	.rank-1 {
		background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
		box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
	}

	.rank-2 {
		background: linear-gradient(135deg, #C0C0C0 0%, #A0A0A0 100%);
		box-shadow: 0 4px 12px rgba(192, 192, 192, 0.4);
	}

	.rank-3 {
		background: linear-gradient(135deg, #CD7F32 0%, #B87333 100%);
		box-shadow: 0 4px 12px rgba(205, 127, 50, 0.4);
	}

	.rank-other {
		background: linear-gradient(135deg, var(--light-brown) 0%, #8B6F47 100%);
	}

	.product-name {
		font-weight: 600;
		color: var(--dark-brown);
		font-size: 16px;
	}

	.product-brand {
		font-size: 14px;
		color: var(--light-brown);
		margin-top: 4px;
	}

	.sold-count {
		font-size: 20px;
		font-weight: 700;
		color: var(--light-brown);
		font-family: 'Playfair Display', serif;
	}

	.empty-state {
		text-align: center;
		padding: 60px 20px;
		color: var(--text-dark);
	}

	.empty-state-icon {
		font-size: 64px;
		color: var(--light-brown);
		opacity: 0.5;
		margin-bottom: 20px;
	}

	.empty-state-text {
		font-size: 18px;
		color: var(--text-dark);
	}
</style>

<div class="reports-container">
	<div class="reports-header">
		<h1 class="reports-title">Top Selling Products</h1>
		<form method="get" action="/Reports/TopFiveSellingProducts" class="date-filter-form">
			<div class="date-filter-group">
				<label for="sDate">Start Date</label>
				<input type="date" id="sDate" name="sDate" value="@Model.StartDate.ToString("yyyy-MM-dd")" />
			</div>
			<div class="date-filter-group">
				<label for="eDate">End Date</label>
				<input type="date" id="eDate" name="eDate" value="@Model.EndDate.ToString("yyyy-MM-dd")" />
			</div>
			<button type="submit" class="filter-btn">
				<i class="bi bi-funnel"></i> Filter
			</button>
		</form>
	</div>

	<div class="reports-content">
		<div class="date-range-info">
			<i class="bi bi-calendar-range"></i>
			<strong>Date Range:</strong> @Model.StartDate.ToString("dd MMM yyyy") - @Model.EndDate.ToString("dd MMM yyyy")
		</div>

		@if (Model.TopNSoldProducts != null && Model.TopNSoldProducts.Any())
		{
			<table class="products-table">
				<thead>
					<tr>
						<th style="width: 80px;">Rank</th>
						<th>Product</th>
						<th style="text-align: right;">Units Sold</th>
					</tr>
				</thead>
				<tbody>
					@{
						int rank = 1;
					}
					@foreach (var product in Model.TopNSoldProducts)
					{
						var rankClass = rank switch
						{
							1 => "rank-1",
							2 => "rank-2",
							3 => "rank-3",
							_ => "rank-other"
						};
						<tr>
							<td>
								<span class="rank-badge @rankClass">@rank</span>
							</td>
							<td>
								<div class="product-name">@product.ProductName</div>
								<div class="product-brand">@product.BrandName</div>
							</td>
							<td style="text-align: right;">
								<span class="sold-count">@product.TotalUnitSold</span>
								<span style="color: var(--text-dark); font-size: 14px; margin-left: 5px;">units</span>
							</td>
						</tr>
						rank++;
					}
				</tbody>
			</table>
		}
		else
		{
			<div class="empty-state">
				<i class="bi bi-inbox empty-state-icon"></i>
				<div class="empty-state-text">No sales data found for the selected date range.</div>
			</div>
		}
	</div>
</div>

